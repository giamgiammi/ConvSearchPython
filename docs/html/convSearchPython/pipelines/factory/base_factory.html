<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>convSearchPython.pipelines.factory.base_factory API documentation</title>
<meta name="description" content="This module contains a Pipeline Factory implementation for the common case
of rewriter -&gt; model -&gt; RM3 -&gt; reranker." />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML" integrity="sha256-kZafAc6mZvK3W3v1pHOcUix30OHQN6pU/NO2oFkqZVw=" crossorigin></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>convSearchPython.pipelines.factory.base_factory</code></h1>
</header>
<section id="section-intro">
<p>This module contains a Pipeline Factory implementation for the common case
of rewriter -&gt; model -&gt; RM3 -&gt; reranker.</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;
This module contains a Pipeline Factory implementation for the common case
of rewriter -&gt; model -&gt; RM3 -&gt; reranker.
&#34;&#34;&#34;
import logging
from typing import Optional, Dict, Any, Tuple

from convSearchPython.pipelines import Model, Rewriter, Reranker, RM3, ChainPipeline
from convSearchPython.pipelines.factory import PipelineFactory
from convSearchPython.utils.imports import instantiate_class


class BasePipelineFactory(PipelineFactory):
    &#34;&#34;&#34;
    Factory to build a pipeline composed of:

    rewriter -&gt; model -&gt; rm3 -&gt; reranker

    Only model is mandatory.

    Example of configuration:

    ```
    factory1 = convSearchPython.pipelines.factory.base_factory.BasePipelineFactory
    factory1.model = DirichletLM
    factory1.model.num_results = 1000
    factory1.model.c = 2500
    factory1.rewriter = full.path.to.rewriter
    factory1.rewriter.p1 = 10
    factory1.rm3.terms = 20
    factory1.rm3.docs = 20
    factory1.rm3.lambda = 0.5
    factory1.reranker = full.path.to.reranker
    factory1.reranker.p2 = true
    ```
    &#34;&#34;&#34;

    def __init__(self, **kwargs):
        &#34;&#34;&#34;
        Args:
            **kwargs: common arguments for pipelines
        &#34;&#34;&#34;
        super().__init__(**kwargs)

        self._rm3: Optional[Dict[str, Any]] = None
        self._reranker: Optional[Tuple[str, tuple, Dict[str, Any]]] = None
        self._rewriter: Optional[Tuple[str, tuple, Dict[str, Any]]] = None
        self._model: Optional[Dict[str, Any]] = None
        self._kwargs = kwargs

        self._logger = logging.getLogger(self.__class__.__name__)

    @property
    def model(self) -&gt; Optional[Model]:
        &#34;&#34;&#34;Model (wrapper) object&#34;&#34;&#34;
        return Model(**self._model) \
            if self._model is not None else None

    @property
    def rewriter(self) -&gt; Optional[Rewriter]:
        &#34;&#34;&#34;Rewriter object&#34;&#34;&#34;
        return instantiate_class(self._rewriter[0], *self._rewriter[1], **{**self._kwargs, **self._rewriter[2]}) \
            if self._rewriter is not None else None

    @property
    def reranker(self) -&gt; Optional[Reranker]:
        &#34;&#34;&#34;Reranker object&#34;&#34;&#34;
        return instantiate_class(self._reranker[0], *self._reranker[1], **{**self._kwargs, **self._reranker[2]}) \
            if self._reranker is not None else None

    @property
    def rm3(self) -&gt; Optional[RM3]:
        &#34;&#34;&#34;RM3 (wrapper) object&#34;&#34;&#34;
        return RM3(**self._rm3) if self._rm3 is not None else None

    def set(self, config: Dict[str, Any]):
        model_wmodel = None
        model = {}
        rewriter_class = None
        rewriter = {}
        reranker_class = None
        reranker = {}
        rm3 = {}

        for key, value in config.items():
            if key.startswith(&#39;model.&#39;):
                key = key[6:]
                model[key] = value
            elif key.startswith(&#39;rewriter.&#39;):
                key = key[9:]
                rewriter[key] = value
            elif key.startswith(&#39;reranker.&#39;):
                key = key[9:]
                reranker[key] = value
            elif key == &#39;rm3.terms&#39;:
                rm3[&#39;fb_terms&#39;] = value
            elif key == &#39;rm3.docs&#39;:
                rm3[&#39;fb_docs&#39;] = value
            elif key == &#39;rm3.lambda&#39;:
                rm3[&#39;fb_lambda&#39;] = value
            elif key == &#39;model&#39;:
                model_wmodel = value
            elif key == &#39;rewriter&#39;:
                rewriter_class = value
            elif key == &#39;reranker&#39;:
                reranker_class = value
            else:
                self._logger.warning(&#39;unknown parameter &#34;%s&#34;, ignoring...&#39;, key)

        if model_wmodel is not None:
            self.set_model(model_wmodel, **model)
        elif len(model) &gt; 0:
            self._logger.warning(&#39;ignoring model.* parameters because model is not set&#39;)

        if rewriter_class is not None:
            self.set_rewriter(rewriter_class, **rewriter)
        elif len(rewriter) &gt; 0:
            self._logger.warning(&#39;ignoring rewriter.* parameters because rewriter is not set&#39;)

        if reranker_class is not None:
            self.set_reranker(reranker_class, **reranker)
        elif len(reranker) &gt; 0:
            self._logger.warning(&#39;ignoring reranker.* parameters because reranker is not set&#39;)

        if len(rm3) &gt; 0:
            self.set_rm3(**rm3)

    def set_model(self, wmodel: str, **controls):
        &#34;&#34;&#34;
        Set the pipeline model
        Args:
            wmodel: name of the model (pyterrier wmodel BatchRetrieve parameter)
            **controls: model configuration parameters
        &#34;&#34;&#34;
        self._model = {&#39;wmodel&#39;: wmodel, &#39;controls&#39;: controls,
                       &#39;index&#39;: self._kwargs[&#39;index&#39;], &#39;metadata&#39;: self._kwargs[&#39;metadata&#39;]}

    def set_rewriter(self, classname: str, *args, **kwargs):
        &#34;&#34;&#34;
        Set pipeline rewriter
        Args:
            classname: rewriter classname
            *args: positional arguments
            **kwargs: dict arguments
        &#34;&#34;&#34;
        self._rewriter = (classname, args, kwargs)

    def set_reranker(self, classname: str, *args, **kwargs):
        &#34;&#34;&#34;
        Set pipeline reranker
        Args:
            classname: reranker classname
            *args: positional arguments
            **kwargs: dict arguments
        &#34;&#34;&#34;
        self._reranker = (classname, args, kwargs)

    def set_rm3(self, fb_terms: int, fb_docs: int, fb_lambda: float):
        &#34;&#34;&#34;
        Set pipeline RM3
        Args:
            fb_terms: number of best terms to consider
            fb_docs: number of docs to consider
            fb_lambda: lambda factor
        &#34;&#34;&#34;
        self._rm3 = {
            **self._kwargs,
            &#39;index&#39;: self._kwargs[&#39;index&#39;], &#39;fb_terms&#39;: fb_terms,
            &#39;fb_docs&#39;: fb_docs, &#39;fb_lambda&#39;: fb_lambda
        }

    def build(self) -&gt; ChainPipeline:
        model = self.model
        rewriter = self.rewriter
        rm3 = self.rm3
        reranker = self.reranker
        if model is None:
            raise TypeError(&#39;missing model&#39;)
        name_parts = [f&#39;{model.name}&#39;, &#39;none&#39;, &#39;none&#39;, &#39;none&#39;]
        steps = []
        if rewriter is not None:
            steps.append(rewriter)
            name_parts[1] = getattr(rewriter, &#39;name&#39;, rewriter.__class__.__name__)
        if rm3 is not None:
            steps.extend((model, rm3, model))
            name_parts[2] = rm3.name
        if reranker is not None:
            steps.append(reranker)
            name_parts[3] = getattr(reranker, &#39;name&#39;, reranker.__class__.__name__)

        return ChainPipeline(steps, &#39;_&#39;.join(name_parts), **self._kwargs)


if __name__ == &#39;__main__&#39;:
    from convSearchPython.dataset.CAsT import cast_dataset

    queries, qrels, conversations, query_map = cast_dataset(2019)
    commons = {
        &#39;queries&#39;: queries,
        &#39;conversations&#39;: conversations,
        &#39;query_map&#39;: query_map,
        &#39;metadata&#39;: [&#39;docno&#39;],
        &#39;index&#39;: &#39;custom&#39;,
    }
    factory = BasePipelineFactory(**commons)
    factory.set({
        &#39;model&#39;: &#39;BM25&#39;,
        &#39;model.c&#39;: 0.75,
        &#39;rm3.terms&#39;: 15,
        &#39;rm3.docs&#39;: 5,
        &#39;rm3.lambda&#39;: 0.4,
    })

    pipeline: ChainPipeline = factory.build()
    print(pipeline)
    print(pipeline.steps)
    print(pipeline.name)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="convSearchPython.pipelines.factory.base_factory.BasePipelineFactory"><code class="flex name class">
<span>class <span class="ident">BasePipelineFactory</span></span>
<span>(</span><span>**kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Factory to build a pipeline composed of:</p>
<p>rewriter -&gt; model -&gt; rm3 -&gt; reranker</p>
<p>Only model is mandatory.</p>
<p>Example of configuration:</p>
<pre><code>factory1 = convSearchPython.pipelines.factory.base_factory.BasePipelineFactory
factory1.model = DirichletLM
factory1.model.num_results = 1000
factory1.model.c = 2500
factory1.rewriter = full.path.to.rewriter
factory1.rewriter.p1 = 10
factory1.rm3.terms = 20
factory1.rm3.docs = 20
factory1.rm3.lambda = 0.5
factory1.reranker = full.path.to.reranker
factory1.reranker.p2 = true
</code></pre>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>**kwargs</code></strong></dt>
<dd>common arguments for pipelines</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class BasePipelineFactory(PipelineFactory):
    &#34;&#34;&#34;
    Factory to build a pipeline composed of:

    rewriter -&gt; model -&gt; rm3 -&gt; reranker

    Only model is mandatory.

    Example of configuration:

    ```
    factory1 = convSearchPython.pipelines.factory.base_factory.BasePipelineFactory
    factory1.model = DirichletLM
    factory1.model.num_results = 1000
    factory1.model.c = 2500
    factory1.rewriter = full.path.to.rewriter
    factory1.rewriter.p1 = 10
    factory1.rm3.terms = 20
    factory1.rm3.docs = 20
    factory1.rm3.lambda = 0.5
    factory1.reranker = full.path.to.reranker
    factory1.reranker.p2 = true
    ```
    &#34;&#34;&#34;

    def __init__(self, **kwargs):
        &#34;&#34;&#34;
        Args:
            **kwargs: common arguments for pipelines
        &#34;&#34;&#34;
        super().__init__(**kwargs)

        self._rm3: Optional[Dict[str, Any]] = None
        self._reranker: Optional[Tuple[str, tuple, Dict[str, Any]]] = None
        self._rewriter: Optional[Tuple[str, tuple, Dict[str, Any]]] = None
        self._model: Optional[Dict[str, Any]] = None
        self._kwargs = kwargs

        self._logger = logging.getLogger(self.__class__.__name__)

    @property
    def model(self) -&gt; Optional[Model]:
        &#34;&#34;&#34;Model (wrapper) object&#34;&#34;&#34;
        return Model(**self._model) \
            if self._model is not None else None

    @property
    def rewriter(self) -&gt; Optional[Rewriter]:
        &#34;&#34;&#34;Rewriter object&#34;&#34;&#34;
        return instantiate_class(self._rewriter[0], *self._rewriter[1], **{**self._kwargs, **self._rewriter[2]}) \
            if self._rewriter is not None else None

    @property
    def reranker(self) -&gt; Optional[Reranker]:
        &#34;&#34;&#34;Reranker object&#34;&#34;&#34;
        return instantiate_class(self._reranker[0], *self._reranker[1], **{**self._kwargs, **self._reranker[2]}) \
            if self._reranker is not None else None

    @property
    def rm3(self) -&gt; Optional[RM3]:
        &#34;&#34;&#34;RM3 (wrapper) object&#34;&#34;&#34;
        return RM3(**self._rm3) if self._rm3 is not None else None

    def set(self, config: Dict[str, Any]):
        model_wmodel = None
        model = {}
        rewriter_class = None
        rewriter = {}
        reranker_class = None
        reranker = {}
        rm3 = {}

        for key, value in config.items():
            if key.startswith(&#39;model.&#39;):
                key = key[6:]
                model[key] = value
            elif key.startswith(&#39;rewriter.&#39;):
                key = key[9:]
                rewriter[key] = value
            elif key.startswith(&#39;reranker.&#39;):
                key = key[9:]
                reranker[key] = value
            elif key == &#39;rm3.terms&#39;:
                rm3[&#39;fb_terms&#39;] = value
            elif key == &#39;rm3.docs&#39;:
                rm3[&#39;fb_docs&#39;] = value
            elif key == &#39;rm3.lambda&#39;:
                rm3[&#39;fb_lambda&#39;] = value
            elif key == &#39;model&#39;:
                model_wmodel = value
            elif key == &#39;rewriter&#39;:
                rewriter_class = value
            elif key == &#39;reranker&#39;:
                reranker_class = value
            else:
                self._logger.warning(&#39;unknown parameter &#34;%s&#34;, ignoring...&#39;, key)

        if model_wmodel is not None:
            self.set_model(model_wmodel, **model)
        elif len(model) &gt; 0:
            self._logger.warning(&#39;ignoring model.* parameters because model is not set&#39;)

        if rewriter_class is not None:
            self.set_rewriter(rewriter_class, **rewriter)
        elif len(rewriter) &gt; 0:
            self._logger.warning(&#39;ignoring rewriter.* parameters because rewriter is not set&#39;)

        if reranker_class is not None:
            self.set_reranker(reranker_class, **reranker)
        elif len(reranker) &gt; 0:
            self._logger.warning(&#39;ignoring reranker.* parameters because reranker is not set&#39;)

        if len(rm3) &gt; 0:
            self.set_rm3(**rm3)

    def set_model(self, wmodel: str, **controls):
        &#34;&#34;&#34;
        Set the pipeline model
        Args:
            wmodel: name of the model (pyterrier wmodel BatchRetrieve parameter)
            **controls: model configuration parameters
        &#34;&#34;&#34;
        self._model = {&#39;wmodel&#39;: wmodel, &#39;controls&#39;: controls,
                       &#39;index&#39;: self._kwargs[&#39;index&#39;], &#39;metadata&#39;: self._kwargs[&#39;metadata&#39;]}

    def set_rewriter(self, classname: str, *args, **kwargs):
        &#34;&#34;&#34;
        Set pipeline rewriter
        Args:
            classname: rewriter classname
            *args: positional arguments
            **kwargs: dict arguments
        &#34;&#34;&#34;
        self._rewriter = (classname, args, kwargs)

    def set_reranker(self, classname: str, *args, **kwargs):
        &#34;&#34;&#34;
        Set pipeline reranker
        Args:
            classname: reranker classname
            *args: positional arguments
            **kwargs: dict arguments
        &#34;&#34;&#34;
        self._reranker = (classname, args, kwargs)

    def set_rm3(self, fb_terms: int, fb_docs: int, fb_lambda: float):
        &#34;&#34;&#34;
        Set pipeline RM3
        Args:
            fb_terms: number of best terms to consider
            fb_docs: number of docs to consider
            fb_lambda: lambda factor
        &#34;&#34;&#34;
        self._rm3 = {
            **self._kwargs,
            &#39;index&#39;: self._kwargs[&#39;index&#39;], &#39;fb_terms&#39;: fb_terms,
            &#39;fb_docs&#39;: fb_docs, &#39;fb_lambda&#39;: fb_lambda
        }

    def build(self) -&gt; ChainPipeline:
        model = self.model
        rewriter = self.rewriter
        rm3 = self.rm3
        reranker = self.reranker
        if model is None:
            raise TypeError(&#39;missing model&#39;)
        name_parts = [f&#39;{model.name}&#39;, &#39;none&#39;, &#39;none&#39;, &#39;none&#39;]
        steps = []
        if rewriter is not None:
            steps.append(rewriter)
            name_parts[1] = getattr(rewriter, &#39;name&#39;, rewriter.__class__.__name__)
        if rm3 is not None:
            steps.extend((model, rm3, model))
            name_parts[2] = rm3.name
        if reranker is not None:
            steps.append(reranker)
            name_parts[3] = getattr(reranker, &#39;name&#39;, reranker.__class__.__name__)

        return ChainPipeline(steps, &#39;_&#39;.join(name_parts), **self._kwargs)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="convSearchPython.pipelines.factory.PipelineFactory" href="index.html#convSearchPython.pipelines.factory.PipelineFactory">PipelineFactory</a></li>
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="convSearchPython.pipelines.factory.sub_index.SubIndexPipelineFactory" href="sub_index.html#convSearchPython.pipelines.factory.sub_index.SubIndexPipelineFactory">SubIndexPipelineFactory</a></li>
</ul>
<h3>Instance variables</h3>
<dl>
<dt id="convSearchPython.pipelines.factory.base_factory.BasePipelineFactory.model"><code class="name">var <span class="ident">model</span> : Optional[<a title="convSearchPython.pipelines.Model" href="../index.html#convSearchPython.pipelines.Model">Model</a>]</code></dt>
<dd>
<div class="desc"><p>Model (wrapper) object</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def model(self) -&gt; Optional[Model]:
    &#34;&#34;&#34;Model (wrapper) object&#34;&#34;&#34;
    return Model(**self._model) \
        if self._model is not None else None</code></pre>
</details>
</dd>
<dt id="convSearchPython.pipelines.factory.base_factory.BasePipelineFactory.rewriter"><code class="name">var <span class="ident">rewriter</span> : Optional[<a title="convSearchPython.pipelines.Rewriter" href="../index.html#convSearchPython.pipelines.Rewriter">Rewriter</a>]</code></dt>
<dd>
<div class="desc"><p>Rewriter object</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def rewriter(self) -&gt; Optional[Rewriter]:
    &#34;&#34;&#34;Rewriter object&#34;&#34;&#34;
    return instantiate_class(self._rewriter[0], *self._rewriter[1], **{**self._kwargs, **self._rewriter[2]}) \
        if self._rewriter is not None else None</code></pre>
</details>
</dd>
<dt id="convSearchPython.pipelines.factory.base_factory.BasePipelineFactory.reranker"><code class="name">var <span class="ident">reranker</span> : Optional[<a title="convSearchPython.pipelines.Reranker" href="../index.html#convSearchPython.pipelines.Reranker">Reranker</a>]</code></dt>
<dd>
<div class="desc"><p>Reranker object</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def reranker(self) -&gt; Optional[Reranker]:
    &#34;&#34;&#34;Reranker object&#34;&#34;&#34;
    return instantiate_class(self._reranker[0], *self._reranker[1], **{**self._kwargs, **self._reranker[2]}) \
        if self._reranker is not None else None</code></pre>
</details>
</dd>
<dt id="convSearchPython.pipelines.factory.base_factory.BasePipelineFactory.rm3"><code class="name">var <span class="ident">rm3</span> : Optional[<a title="convSearchPython.pipelines.RM3" href="../index.html#convSearchPython.pipelines.RM3">RM3</a>]</code></dt>
<dd>
<div class="desc"><p>RM3 (wrapper) object</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def rm3(self) -&gt; Optional[RM3]:
    &#34;&#34;&#34;RM3 (wrapper) object&#34;&#34;&#34;
    return RM3(**self._rm3) if self._rm3 is not None else None</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="convSearchPython.pipelines.factory.base_factory.BasePipelineFactory.set_model"><code class="name flex">
<span>def <span class="ident">set_model</span></span>(<span>self, wmodel: str, **controls)</span>
</code></dt>
<dd>
<div class="desc"><p>Set the pipeline model</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>wmodel</code></strong></dt>
<dd>name of the model (pyterrier wmodel BatchRetrieve parameter)</dd>
<dt><strong><code>**controls</code></strong></dt>
<dd>model configuration parameters</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_model(self, wmodel: str, **controls):
    &#34;&#34;&#34;
    Set the pipeline model
    Args:
        wmodel: name of the model (pyterrier wmodel BatchRetrieve parameter)
        **controls: model configuration parameters
    &#34;&#34;&#34;
    self._model = {&#39;wmodel&#39;: wmodel, &#39;controls&#39;: controls,
                   &#39;index&#39;: self._kwargs[&#39;index&#39;], &#39;metadata&#39;: self._kwargs[&#39;metadata&#39;]}</code></pre>
</details>
</dd>
<dt id="convSearchPython.pipelines.factory.base_factory.BasePipelineFactory.set_rewriter"><code class="name flex">
<span>def <span class="ident">set_rewriter</span></span>(<span>self, classname: str, *args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Set pipeline rewriter</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>classname</code></strong></dt>
<dd>rewriter classname</dd>
<dt><strong><code>*args</code></strong></dt>
<dd>positional arguments</dd>
<dt><strong><code>**kwargs</code></strong></dt>
<dd>dict arguments</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_rewriter(self, classname: str, *args, **kwargs):
    &#34;&#34;&#34;
    Set pipeline rewriter
    Args:
        classname: rewriter classname
        *args: positional arguments
        **kwargs: dict arguments
    &#34;&#34;&#34;
    self._rewriter = (classname, args, kwargs)</code></pre>
</details>
</dd>
<dt id="convSearchPython.pipelines.factory.base_factory.BasePipelineFactory.set_reranker"><code class="name flex">
<span>def <span class="ident">set_reranker</span></span>(<span>self, classname: str, *args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Set pipeline reranker</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>classname</code></strong></dt>
<dd>reranker classname</dd>
<dt><strong><code>*args</code></strong></dt>
<dd>positional arguments</dd>
<dt><strong><code>**kwargs</code></strong></dt>
<dd>dict arguments</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_reranker(self, classname: str, *args, **kwargs):
    &#34;&#34;&#34;
    Set pipeline reranker
    Args:
        classname: reranker classname
        *args: positional arguments
        **kwargs: dict arguments
    &#34;&#34;&#34;
    self._reranker = (classname, args, kwargs)</code></pre>
</details>
</dd>
<dt id="convSearchPython.pipelines.factory.base_factory.BasePipelineFactory.set_rm3"><code class="name flex">
<span>def <span class="ident">set_rm3</span></span>(<span>self, fb_terms: int, fb_docs: int, fb_lambda: float)</span>
</code></dt>
<dd>
<div class="desc"><p>Set pipeline RM3</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>fb_terms</code></strong></dt>
<dd>number of best terms to consider</dd>
<dt><strong><code>fb_docs</code></strong></dt>
<dd>number of docs to consider</dd>
<dt><strong><code>fb_lambda</code></strong></dt>
<dd>lambda factor</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_rm3(self, fb_terms: int, fb_docs: int, fb_lambda: float):
    &#34;&#34;&#34;
    Set pipeline RM3
    Args:
        fb_terms: number of best terms to consider
        fb_docs: number of docs to consider
        fb_lambda: lambda factor
    &#34;&#34;&#34;
    self._rm3 = {
        **self._kwargs,
        &#39;index&#39;: self._kwargs[&#39;index&#39;], &#39;fb_terms&#39;: fb_terms,
        &#39;fb_docs&#39;: fb_docs, &#39;fb_lambda&#39;: fb_lambda
    }</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="convSearchPython.pipelines.factory.PipelineFactory" href="index.html#convSearchPython.pipelines.factory.PipelineFactory">PipelineFactory</a></b></code>:
<ul class="hlist">
<li><code><a title="convSearchPython.pipelines.factory.PipelineFactory.build" href="index.html#convSearchPython.pipelines.factory.PipelineFactory.build">build</a></code></li>
<li><code><a title="convSearchPython.pipelines.factory.PipelineFactory.set" href="index.html#convSearchPython.pipelines.factory.PipelineFactory.set">set</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="convSearchPython.pipelines.factory" href="index.html">convSearchPython.pipelines.factory</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="convSearchPython.pipelines.factory.base_factory.BasePipelineFactory" href="#convSearchPython.pipelines.factory.base_factory.BasePipelineFactory">BasePipelineFactory</a></code></h4>
<ul class="two-column">
<li><code><a title="convSearchPython.pipelines.factory.base_factory.BasePipelineFactory.set_model" href="#convSearchPython.pipelines.factory.base_factory.BasePipelineFactory.set_model">set_model</a></code></li>
<li><code><a title="convSearchPython.pipelines.factory.base_factory.BasePipelineFactory.set_rewriter" href="#convSearchPython.pipelines.factory.base_factory.BasePipelineFactory.set_rewriter">set_rewriter</a></code></li>
<li><code><a title="convSearchPython.pipelines.factory.base_factory.BasePipelineFactory.set_reranker" href="#convSearchPython.pipelines.factory.base_factory.BasePipelineFactory.set_reranker">set_reranker</a></code></li>
<li><code><a title="convSearchPython.pipelines.factory.base_factory.BasePipelineFactory.set_rm3" href="#convSearchPython.pipelines.factory.base_factory.BasePipelineFactory.set_rm3">set_rm3</a></code></li>
<li><code><a title="convSearchPython.pipelines.factory.base_factory.BasePipelineFactory.model" href="#convSearchPython.pipelines.factory.base_factory.BasePipelineFactory.model">model</a></code></li>
<li><code><a title="convSearchPython.pipelines.factory.base_factory.BasePipelineFactory.rewriter" href="#convSearchPython.pipelines.factory.base_factory.BasePipelineFactory.rewriter">rewriter</a></code></li>
<li><code><a title="convSearchPython.pipelines.factory.base_factory.BasePipelineFactory.reranker" href="#convSearchPython.pipelines.factory.base_factory.BasePipelineFactory.reranker">reranker</a></code></li>
<li><code><a title="convSearchPython.pipelines.factory.base_factory.BasePipelineFactory.rm3" href="#convSearchPython.pipelines.factory.base_factory.BasePipelineFactory.rm3">rm3</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>